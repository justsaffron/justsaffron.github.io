<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PM Projects — Just Saffron</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Lilex:wght@100;200;300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="shared.css">
<style>
.project-card { display:grid; grid-template-columns:210px 1fr; border:1px solid var(--border); margin-bottom:1px; background:var(--navy-mid); position:relative; overflow:hidden; transition:border-color 0.3s; }
.project-card::before { content:''; position:absolute; left:0; top:0; width:2px; height:0; background:var(--saffron); transition:height 0.4s; }
.project-card:hover { border-color:rgba(232,170,68,0.3); }
.project-card:hover::before { height:100%; }
.proj-meta { padding:1.8rem 1.5rem; border-right:1px solid var(--border); display:flex; flex-direction:column; gap:0.8rem; background:rgba(20,24,50,0.4); }
.proj-index { font-size:0.5rem; letter-spacing:0.3em; color:var(--sky); }
.proj-name  { font-size:1rem; font-weight:400; color:var(--white); line-height:1.3; }
.proj-time  { font-size:0.57rem; color:var(--text-dim); letter-spacing:0.1em; }
.proj-progress-label { font-size:0.48rem; letter-spacing:0.2em; text-transform:uppercase; color:var(--text-dim); margin-top:auto; }
.proj-progress-bar  { height:2px; background:rgba(125,183,202,0.12); margin-top:0.4rem; }
.proj-progress-fill { height:100%; background:linear-gradient(90deg,var(--blue),var(--sky)); transition:width 1.2s ease; }
.proj-body { padding:1.8rem; display:grid; grid-template-columns:repeat(3,1fr); gap:1.4rem; }
.proj-field label { display:block; font-size:0.48rem; letter-spacing:0.25em; text-transform:uppercase; color:var(--text-dim); margin-bottom:0.45rem; }
.proj-field p { font-size:0.68rem; font-weight:300; line-height:1.8; color:var(--text-warm); }
.proj-field.full { grid-column:1/-1; }
.proj-tags  { display:flex; flex-wrap:wrap; gap:0.4rem; margin-top:0.4rem; }
.proj-actions { grid-column:1/-1; display:flex; gap:0.8rem; padding-top:1rem; border-top:1px solid var(--border); }
.add-row { display:flex; align-items:center; justify-content:center; gap:1rem; padding:1.8rem; border:1px dashed rgba(125,183,202,0.15); color:var(--text-dim); font-size:0.58rem; letter-spacing:0.3em; text-transform:uppercase; cursor:pointer; transition:all 0.3s; margin-top:1px; background:none; font-family:var(--font); width:100%; }
.add-row:hover { border-color:rgba(232,170,68,0.38); color:var(--saffron); background:var(--saffron-dim); }
</style>
</head>
<body>
<nav>
  <a class="nav-logo" href="index.html">Just Saffron</a>
  <ul class="nav-links">
    <li><a href="projects.html" class="active">Projects</a></li>
    <li><a href="mtg.html">Decks</a></li>
    <li><a href="moodboards.html">Moodboards</a></li>
    <li><a href="photography.html">Photography</a></li>
    <li><a href="reviews.html">Reviews</a></li>
    <li><a href="resources.html">Resources</a></li>
    <li><a href="editor.html" class="edit-link">✦ Edit</a></li>
  </ul>
</nav>
<div class="page-header">
  <div class="page-header-left">
    <p class="page-eyebrow">01 · PM Projects</p>
    <h1 class="page-title">Product <em>Work</em></h1>
    <p class="page-subtitle">A full record of PM projects — the problem, approach, time invested, sources of inspiration, and what I walked away having learned.</p>
  </div>
  <button class="btn btn-primary" data-auth onclick="requireAuth(()=>openModal('project-modal'))">+ New Project</button>
</div>
<div class="page-content">
  <div class="filter-bar">
    <button class="filter-btn active" onclick="filterProjects('all',this)">All</button>
    <button class="filter-btn" onclick="filterProjects('In Progress',this)">In Progress</button>
    <button class="filter-btn" onclick="filterProjects('Completed',this)">Completed</button>
    <button class="filter-btn" onclick="filterProjects('On Hold',this)">On Hold</button>
    <button class="filter-btn" onclick="filterProjects('Planning',this)">Planning</button>
  </div>
  <div id="project-list"></div>
  <button class="add-row" data-auth onclick="requireAuth(()=>openModal('project-modal'))"><span>+</span><span>Add New Project</span></button>
</div>
<footer class="site-footer">
  <div class="site-footer-sig">Just Saffron · <a href="index.html">← Home</a></div>
  <a href="editor.html" class="btn btn-primary">✦ Edit Content</a>
</footer>

<!-- PROJECT MODAL -->
<div class="modal-bg" id="project-modal">
  <div class="modal">
    <div class="modal-title" id="pmod-label">New PM Project</div>
    <input type="hidden" id="p-edit-idx" value="-1">
    <div class="form-grid">
      <div class="form-row"><label>Project Name *</label><input type="text" id="p-name" placeholder="e.g. Checkout Redesign"></div>
      <div class="form-row"><label>Status</label>
        <select id="p-status"><option>In Progress</option><option>Completed</option><option>On Hold</option><option>Planning</option></select>
      </div>
      <div class="form-row"><label>Time Spent</label><input type="text" id="p-time" placeholder="e.g. 4 weeks"></div>
      <div class="form-row"><label>Progress (0–100)</label><input type="number" id="p-progress" min="0" max="100" value="0"></div>
    </div>
    <div class="form-row"><label>Problem Statement *</label><textarea id="p-problem" placeholder="What problem were you solving?"></textarea></div>
    <div class="form-row"><label>Approach</label><textarea id="p-approach" placeholder="How did you go about it?"></textarea></div>
    <div class="form-row"><label>Key Learning</label><textarea id="p-learning" placeholder="What did you take away?"></textarea></div>
    <div class="form-row"><label>Sources of Inspiration</label><input type="text" id="p-inspiration" placeholder="e.g. Stripe Docs, Duolingo onboarding, JTBD framework"></div>
    <div class="form-row"><label>GitHub / Link (optional)</label><input type="url" id="p-link" placeholder="https://..."></div>
    <div class="modal-actions">
      <button class="btn" onclick="closeModal('project-modal')">Cancel</button>
      <button class="btn btn-primary" onclick="saveProject()">Save Project</button>
    </div>
  </div>
</div>

<script src="auth.js"></script>
<script>
const KEY = 'waanderer_projects';
function getP() { return JSON.parse(localStorage.getItem(KEY)||'[]'); }
function setP(a){ localStorage.setItem(KEY,JSON.stringify(a)); }
let activeFilter='all';

function statusDot(s){
  if(s==='In Progress') return '<span class="dot dot-active"></span>';
  if(s==='Completed')   return '<span class="dot dot-done"></span>';
  return '<span class="dot dot-hold"></span>';
}

function saveProject(){
  const idx=parseInt(document.getElementById('p-edit-idx').value);
  const p={ name:document.getElementById('p-name').value.trim(), status:document.getElementById('p-status').value, time:document.getElementById('p-time').value.trim(), progress:parseInt(document.getElementById('p-progress').value)||0, problem:document.getElementById('p-problem').value.trim(), approach:document.getElementById('p-approach').value.trim(), learning:document.getElementById('p-learning').value.trim(), inspiration:document.getElementById('p-inspiration').value.trim(), link:document.getElementById('p-link').value.trim(), date:new Date().toLocaleDateString('en-GB',{month:'short',year:'numeric'}) };
  if(!p.name) return alert('Please add a project name.');
  const arr=getP(); if(idx>=0) arr[idx]=p; else arr.push(p); setP(arr);
  closeModal('project-modal'); render();
}

function deleteProject(idx){ if(!confirm('Delete this project?')) return; const a=getP(); a.splice(idx,1); setP(a); render(); }

function editProject(idx){
  const p=getP()[idx];
  document.getElementById('p-edit-idx').value=idx; document.getElementById('pmod-label').textContent='Edit Project';
  document.getElementById('p-name').value=p.name; document.getElementById('p-status').value=p.status; document.getElementById('p-time').value=p.time; document.getElementById('p-progress').value=p.progress; document.getElementById('p-problem').value=p.problem; document.getElementById('p-approach').value=p.approach; document.getElementById('p-learning').value=p.learning; document.getElementById('p-inspiration').value=p.inspiration; document.getElementById('p-link').value=p.link||'';
  requireAuth(()=>openModal('project-modal'));
}

function filterProjects(f,btn){ activeFilter=f; document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active')); btn.classList.add('active'); render(); }

function render(){
  const all=getP();
  const filtered=activeFilter==='all'?all:all.filter(p=>p.status===activeFilter);
  const list=document.getElementById('project-list');
  if(!filtered.length){ list.innerHTML=`<div class="empty-state"><div class="empty-icon">⬡</div><p>${activeFilter==='all'?'No projects yet — add your first one':'No projects with this status'}</p></div>`; return; }
  list.innerHTML=filtered.map(p=>{
    const ri=all.indexOf(p);
    const tags=p.inspiration?p.inspiration.split(',').map(t=>`<span class="tag">${t.trim()}</span>`).join(''):'';
    const lnk=p.link?`<a href="${p.link}" target="_blank" class="btn" style="font-size:0.5rem">↗ View</a>`:'';
    return `<div class="project-card reveal">
      <div class="proj-meta">
        <div class="proj-index">PRJ-${String(ri+1).padStart(3,'0')}</div>
        <div class="proj-name">${p.name}</div>
        ${p.time?`<div class="proj-time">⏱ ${p.time}</div>`:''}
        <div class="status-pill">${statusDot(p.status)}<span style="color:var(--text-muted)">${p.status}</span></div>
        <div style="margin-top:auto"><div class="proj-progress-label">${p.progress}% complete</div><div class="proj-progress-bar"><div class="proj-progress-fill" style="width:0%" data-w="${p.progress}%"></div></div></div>
      </div>
      <div class="proj-body">
        ${p.problem?`<div class="proj-field"><label>Problem</label><p>${p.problem}</p></div>`:''}
        ${p.approach?`<div class="proj-field"><label>Approach</label><p>${p.approach}</p></div>`:''}
        ${p.learning?`<div class="proj-field"><label>Key Learning</label><p>${p.learning}</p></div>`:''}
        ${tags?`<div class="proj-field full"><label>Inspiration</label><div class="proj-tags">${tags}</div></div>`:''}
        <div class="proj-actions full">
          <button class="btn" onclick="requireAuth(()=>editProject(${ri}))">✎ Edit</button>
          <button class="btn btn-danger" onclick="requireAuth(()=>deleteProject(${ri}))">✕ Delete</button>
          ${lnk}
          ${p.date?`<span style="margin-left:auto;font-size:0.48rem;color:var(--text-dim);align-self:center">Added ${p.date}</span>`:''}
        </div>
      </div>
    </div>`;
  }).join('');
  setTimeout(()=>{ document.querySelectorAll('.proj-progress-fill').forEach(el=>el.style.width=el.dataset.w); document.querySelectorAll('.reveal').forEach(el=>el.classList.add('visible')); },50);
}

function openModal(id){
  if(id==='project-modal'&&document.getElementById('p-edit-idx').value==='-1'){
    document.getElementById('pmod-label').textContent='New PM Project';
    ['p-name','p-time','p-problem','p-approach','p-learning','p-inspiration','p-link'].forEach(f=>document.getElementById(f).value='');
    document.getElementById('p-progress').value=0; document.getElementById('p-status').value='In Progress';
  }
  document.getElementById(id).classList.add('open'); document.body.style.overflow='hidden';
}
function closeModal(id){ document.getElementById(id).classList.remove('open'); document.getElementById('p-edit-idx').value='-1'; document.body.style.overflow=''; }
document.querySelectorAll('.modal-bg').forEach(bg=>bg.addEventListener('click',e=>{if(e.target===bg)closeModal(bg.id);}));
document.addEventListener('keydown',e=>{if(e.key==='Escape')document.querySelectorAll('.modal-bg.open').forEach(m=>closeModal(m.id));});
render();
</script>
</body>
</html>
